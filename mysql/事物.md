- [事物的特性](#%e4%ba%8b%e7%89%a9%e7%9a%84%e7%89%b9%e6%80%a7)
- [事物的隔离级别](#%e4%ba%8b%e7%89%a9%e7%9a%84%e9%9a%94%e7%a6%bb%e7%ba%a7%e5%88%ab)
- [事物执行带来的问题](#%e4%ba%8b%e7%89%a9%e6%89%a7%e8%a1%8c%e5%b8%a6%e6%9d%a5%e7%9a%84%e9%97%ae%e9%a2%98)
- [不同隔离级别造成的问题及解决的问题](#%e4%b8%8d%e5%90%8c%e9%9a%94%e7%a6%bb%e7%ba%a7%e5%88%ab%e9%80%a0%e6%88%90%e7%9a%84%e9%97%ae%e9%a2%98%e5%8f%8a%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98)
- [长事物](#%e9%95%bf%e4%ba%8b%e7%89%a9)
#### 事物的特性
  * atomicity（原子性）
  * consistency（一致性）
  * isolation（隔离性）
  * durability（持久性）
#### 事物的隔离级别
  * read uncomitted（未提交读）:一个事务还没提交时，它做的变更就能被别的事务看到;
  * read comitted（提交读）:一个事务提交之后，它做的变更才会被其他事务看到;
  * repeatable read（可重复读）:一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的;
  * serializable（串行化）:对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。
#### 事物执行带来的问题
  * dirty read（脏读）
  * non-repeatable read（不可重复读）
  * phantom read（幻读）<br>
    不可重复读例子:事物A在两次读之间，事物B插入或者修改了数据，导致事物A两次读的不一致。
    幻读例子：事物A在两次读之间，事物B插入了数据，之后事物A对插入的数据进行了更改，导致事物A两次读的不一致。
#### 不同隔离级别造成的问题及解决的问题
  * 未提交读有脏读、不可重复读、幻读问题；
  * 提交读解决了脏读，但有不可重复读、幻读问题；
  * 可重复读解决了脏读、不可重复读，但有幻读问题;
  * 串行化解决了脏读、不可重复读、幻读。
#### 长事物
  * 长事务意味着系统里面会存在很老的事务视图。由于这些事务随时可能访问数据库里面的任何数据，所以这个事务提交之前，数据库里面它可能用到的回滚记录都必须保留，这就会导致大量占用存储空间。
  * 在 mysql 5.5 及以前的版本，回滚日志是跟数据字典一起放在 ibdata 文件里的，即使长事务最终提交，回滚段被清理，文件也不会变小。有的数据只有 20GB，而回滚段有 200GB 的库。最终只好为了清理回滚段，重建整个库。除了对回滚段的影响，长事务还占用锁资源，也可能拖垮整个库。所以尽量避免使用长事物。
  