- [如何使用特殊方法](#%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8%e7%89%b9%e6%ae%8a%e6%96%b9%e6%b3%95)
- [\_\_repr__ 和 \_\_str__ 的区别](#repr-%e5%92%8c-str-%e7%9a%84%e5%8c%ba%e5%88%ab)
- [\_\_bool__](#bool)
#### 如何使用特殊方法
* 首先明确一点，特殊方法的存在是为了被 Python 解释器调用的，你自己并不需要调用它 们。也就是说没有 my_object.\_\_len__() 这种写法，而应该使用 len(my_object)。在执行 len(my_object) 的时候，如果 my_object 是一个自定义类的对象，那么 Python 会自己去调 用其中由你实现的 \_\_len__ 方法。
* 然而如果是 Python 内置的类型，比如列表(list)、字符串(str)、字节序列(bytearray) 等，那么 CPython 会抄个近路，\_\_len__ 实际上会直接返回 PyVarObject 里的 ob_size 属 性。PyVarObject 是表示内存中长度可变的内置对象的 C 语言结构体。直接读取这个值比 调用一个方法要快很多。
* 很多时候，特殊方法的调用是隐式的，比如 for i in x: 这个语句，背后其实用的是 iter(x)，而这个函数的背后则是 x.\_\_iter__() 方法。当然前提是这个方法在 x 中被实现了。
#### \_\_repr__ 和 \_\_str__ 的区别
* 交互式控制台和调试程序(debugger)用 repr 函数来获取字符串表示形式;
* \_\_str__是在 str() 函数被使用，或是在用 print 函数打印 一个对象的时候才被调用的，并且它返回的字符串对终端用户更友好；
* 如果你只想实现这两个特殊方法中的一个，\_\_repr__ 是更好的选择，因为如果一个对象没 有 \_\_str__ 函数，而 Python 又需要调用它的时候，解释器会用 \_\_repr__ 作为替代。
#### \_\_bool__
* 尽管 Python 里有 bool 类型，但实际上任何对象都可以用于需要布尔值的上下文中(比如 if 或 while 语句，或者 and、or 和 not 运算符)。为了判定一个值 x 为真还是为假，Python 会调用 bool(x)，这个函数只能返回 True 或者 False。
* 默认情况下，我们自己定义的类的实例总被认为是真的，除非这个类对 \_\_bool__ 或者 __ len__ 函数有自己的实现。bool(x) 的背后是调用 x.\_\_bool__() 的结果；如果不存在 \_\_bool__ 方法，那么 bool(x) 会尝试调用 x.\_\_len__()。若返回 0，则 bool 会返回 False；否则返回 True。
